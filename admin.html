<!DOCTYPE html>
<html lang="zh-TW">
<head>
  </head>
<body>
<div class="container">
  <h2>ğŸ“‹ å¾Œå°ç®¡ç†</h2>
  <div id="login-section" style="text-align:center;">
    <p>ç®¡ç†å“¡ç™»å…¥</p>
    <div id="g_id_onload" data-client_id="1066125366380-tarq5fktrgap3cp3karp2ednbl6vk6n0.apps.googleusercontent.com" data-callback="handleCredentialResponse"></div>
    <div class="g_id_signin" data-type="standard"></div>
  </div>

  <div id="admin-panel" class="hidden">
    <div class="role-select">
        <label>èº«åˆ†åˆ‡æ›ï¼š</label>
        <select id="currentRole" onchange="loadData()">
            <option value="agent">ä»£ç†äºº (åƒ…è«‹å‡)</option>
            <option value="leader">é ˜ç­ (åƒ…è«‹å‡)</option>
            <option value="boss">è€é—†</option>
            <option value="client" selected>ç”²æ–¹(é›»å» )</option>
        </select>
        <button onclick="loadData()">ğŸ”„ åˆ·æ–°</button>
    </div>

    <h3>è«‹å‡å¯©æ ¸</h3>
    <table id="leaveTable">
        <thead><tr><th>å§“å</th><th>å‡åˆ¥</th><th>æ™‚é–“</th><th>é€²åº¦</th><th>æ“ä½œ</th></tr></thead>
        <tbody></tbody>
    </table>

    <h3 style="margin-top:40px;">åŠ ç­å¯©æ ¸ (å…ä»£ç†/é ˜ç­)</h3>
    <table id="otTable">
        <thead><tr><th>å§“å</th><th>é¡å‹</th><th>æ™‚é–“</th><th>é€²åº¦</th><th>æ“ä½œ</th></tr></thead>
        <tbody></tbody>
    </table>
  </div>
</div>

<script>
  // ... GAS_URL èˆ‡ handleCredentialResponse, loadData, renderLeaveTable ç¶­æŒä¸è®Š ...
  
  // åªéœ€ä¿®æ”¹åŠ ç­è¡¨æ ¼çš„æ¸²æŸ“é‚è¼¯ renderOtTable
  function renderOtTable(data) {
    const tbody = document.querySelector(`#otTable tbody`);
    tbody.innerHTML = "";
    data.forEach(item => {
        let role = document.getElementById('currentRole').value;
        // åŠ ç­åªæœ‰ Boss å’Œ Client èƒ½å¯©
        if(role === 'agent' || role === 'leader') {
            tbody.innerHTML = "<tr><td colspan='5'>æ­¤èº«åˆ†ç„¡éœ€å¯©æ ¸åŠ ç­</td></tr>";
            return;
        }

        let myStatus = role === 'boss' ? item.boss : item.client;
        
        let btns = myStatus === 'å¾…å¯©æ ¸' ? 
            `<button class="btn-approve" onclick="review('overtime', ${item.id}, 'åŒæ„')">åŒæ„</button>
             <button class="btn-reject" onclick="review('overtime', ${item.id}, 'é€€å›')">é€€å›</button>` : `<span>${myStatus}</span>`;

        let statusText = `<small>è€:${item.boss} ç”²:${item.client}</small>`;
        tbody.innerHTML += `<tr><td>${item.name}</td><td>${item.type}</td>
            <td><small>${item.start.replace('T',' ')}<br>~${item.end.split('T')[1]}</small></td>
            <td>${statusText}</td><td>${btns}</td></tr>`;
    });
  }

  // ... review å‡½å¼ç¶­æŒä¸è®Š ...
</script>
</body>
</html>
