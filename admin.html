<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>æ¬Šé™ç®¡ç†å¾Œå°</title>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
</head>
<body>
  <h2>ğŸ‘¥ äººå“¡æ¬Šé™ç®¡ç†</h2>
  <button onclick="loadUsers()">è®€å–æ‰€æœ‰äººå“¡</button>
  <div id="user-list"></div>

<script>
  const firebaseConfig = { /* ä½ çš„è¨­å®š */ };
  firebase.initializeApp(firebaseConfig);
  const db = firebase.firestore();

  async function loadUsers() {
    const snapshot = await db.collection('users').get();
    let html = "<table border='1'><tr><th>å§“å</th><th>ç›®å‰èº«åˆ†</th><th>ä¿®æ”¹èº«åˆ†</th></tr>";
    
    snapshot.forEach(doc => {
        let u = doc.data();
        html += `<tr>
            <td>${u.name}</td>
            <td>${u.role}</td>
            <td>
                <select id="role-${doc.id}">
                    <option value="å¤–åŒ…å“¡å·¥">å¤–åŒ…å“¡å·¥</option>
                    <option value="å¤–åŒ…é ˜ç­">å¤–åŒ…é ˜ç­</option>
                    <option value="å¤–åŒ…è€é—†">å¤–åŒ…è€é—†</option>
                    <option value="ç”²æ–¹">ç”²æ–¹</option>
                    <option value="ç®¡ç†è€…">ç®¡ç†è€…</option>
                </select>
                <button onclick="updateRole('${doc.id}')">è®Šæ›´</button>
            </td>
        </tr>`;
    });
    html += "</table>";
    document.getElementById('user-list').innerHTML = html;
  }

  async function updateRole(email) {
    let newRole = document.getElementById('role-' + email).value;
    await db.collection('users').doc(email).update({ role: newRole });
    alert("æ¬Šé™å·²ä¿®æ”¹ç‚ºï¼š" + newRole);
    loadUsers(); // é‡æ–°æ•´ç†
  }
</script>
</body>
</html>
